var _e=Object.defineProperty;var Ue=(b,o,r)=>o in b?_e(b,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):b[o]=r;var F=(b,o,r)=>Ue(b,typeof o!="symbol"?o+"":o,r);import{l as Ve,d as u,m as Q,q as Re,N as ke,U as ye,I as g,A as p,V as T,Q as w,P as s,W as re,X as $,F as X,Y as Z,Z as q,_ as Be,$ as Me,a0 as ce,a1 as le}from"./DGg9CJZi.js";import{l as me}from"./D_d5zky6.js";import"h3";const ee="http://localhost:8080/api/auction",de=[{id:1,name:"高級腕時計",description:"スイス製の高級機械式腕時計",currentPrice:15e3,minPrice:1e4,endTime:new Date(Date.now()+3600*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1524592094714-0f0654e20314?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:3600,bidCount:5,highestBidder:"田中太郎"},{id:2,name:"アンティーク花瓶",description:"江戸時代の有田焼花瓶",currentPrice:25e3,minPrice:15e3,endTime:new Date(Date.now()+3300*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:3300,bidCount:3,highestBidder:"佐藤花子"},{id:3,name:"絵画作品",description:"印象派画家による油絵",currentPrice:8e4,minPrice:5e4,endTime:new Date(Date.now()+3e3*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:3e3,bidCount:8,highestBidder:"山田次郎"},{id:4,name:"宝石ネックレス",description:"ダイヤモンドとサファイアのネックレス",currentPrice:12e4,minPrice:8e4,endTime:new Date(Date.now()+2700*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2700,bidCount:12,highestBidder:"鈴木美咲"},{id:5,name:"古書",description:"明治時代の初版本",currentPrice:35e3,minPrice:2e4,endTime:new Date(Date.now()+2400*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2400,bidCount:6,highestBidder:"高橋一郎"},{id:6,name:"陶器セット",description:"美濃焼の茶器セット",currentPrice:18e3,minPrice:12e3,endTime:new Date(Date.now()+2100*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2100,bidCount:4,highestBidder:"伊藤雅子"},{id:7,name:"銀食器",description:"19世紀の銀製カトラリー",currentPrice:45e3,minPrice:3e4,endTime:new Date(Date.now()+1800*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1582735689369-4fe89db7114c?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:1800,bidCount:7,highestBidder:"渡辺健太"},{id:8,name:"彫刻作品",description:"ブロンズ製の彫刻作品",currentPrice:65e3,minPrice:4e4,endTime:new Date(Date.now()+1500*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:1500,bidCount:9,highestBidder:"中村真理"},{id:9,name:"骨董品",description:"中国明代の青花磁器",currentPrice:95e3,minPrice:6e4,endTime:new Date(Date.now()+1200*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:1200,bidCount:11,highestBidder:"小林正男"},{id:10,name:"真珠ネックレス",description:"天然真珠のネックレス",currentPrice:75e3,minPrice:5e4,endTime:new Date(Date.now()+1080*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:1080,bidCount:8,highestBidder:"佐々木恵子"},{id:11,name:"アンティーク家具",description:"明治時代の桐箪笥",currentPrice:85e3,minPrice:6e4,endTime:new Date(Date.now()+960*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:960,bidCount:6,highestBidder:"田村健一"},{id:12,name:"古銭コレクション",description:"江戸時代の古銭セット",currentPrice:55e3,minPrice:35e3,endTime:new Date(Date.now()+840*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:840,bidCount:10,highestBidder:"井上博文"},{id:13,name:"書道作品",description:"有名書道家の作品",currentPrice:4e4,minPrice:25e3,endTime:new Date(Date.now()+720*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1582735689369-4fe89db7114c?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:720,bidCount:7,highestBidder:"松本美咲"},{id:14,name:"漆器セット",description:"輪島塗の漆器セット",currentPrice:3e4,minPrice:2e4,endTime:new Date(Date.now()+600*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:600,bidCount:5,highestBidder:"山本太郎"},{id:15,name:"刀剣",description:"日本刀の名刀",currentPrice:15e4,minPrice:1e5,endTime:new Date(Date.now()+480*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:480,bidCount:15,highestBidder:"武田信玄"},{id:16,name:"仏像",description:"平安時代の仏像",currentPrice:2e5,minPrice:15e4,endTime:new Date(Date.now()+360*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:360,bidCount:20,highestBidder:"織田信長"},{id:17,name:"掛け軸",description:"江戸時代の山水画",currentPrice:45e3,minPrice:3e4,endTime:new Date(Date.now()+300*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1524592094714-0f0654e20314?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:300,bidCount:8,highestBidder:"徳川家康"},{id:18,name:"茶器",description:"楽焼の茶器",currentPrice:35e3,minPrice:25e3,endTime:new Date(Date.now()+240*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:240,bidCount:6,highestBidder:"千利休"},{id:19,name:"香炉",description:"青銅製の香炉",currentPrice:28e3,minPrice:2e4,endTime:new Date(Date.now()+180*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:180,bidCount:5,highestBidder:"明智光秀"},{id:20,name:"屏風",description:"六曲屏風",currentPrice:12e4,minPrice:8e4,endTime:new Date(Date.now()+120*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:120,bidCount:12,highestBidder:"豊臣秀吉"},{id:21,name:"鏡",description:"江戸時代の鏡",currentPrice:22e3,minPrice:15e3,endTime:new Date(Date.now()+60*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:60,bidCount:4,highestBidder:"北条氏康"},{id:22,name:"櫛",description:"象牙製の櫛",currentPrice:18e3,minPrice:12e3,endTime:new Date(Date.now()+3300*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:3300,bidCount:3,highestBidder:"今川義元"},{id:23,name:"簪",description:"珊瑚の簪",currentPrice:32e3,minPrice:25e3,endTime:new Date(Date.now()+3e3*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1582735689369-4fe89db7114c?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:3e3,bidCount:7,highestBidder:"武田信玄"},{id:24,name:"帯留め",description:"金工の帯留め",currentPrice:15e3,minPrice:1e4,endTime:new Date(Date.now()+2700*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2700,bidCount:5,highestBidder:"上杉謙信"},{id:25,name:"印籠",description:"蒔絵の印籠",currentPrice:38e3,minPrice:28e3,endTime:new Date(Date.now()+2400*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2400,bidCount:9,highestBidder:"毛利元就"},{id:26,name:"根付",description:"象牙の根付",currentPrice:12e3,minPrice:8e3,endTime:new Date(Date.now()+2100*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2100,bidCount:6,highestBidder:"島津義弘"},{id:27,name:"煙管",description:"銀製の煙管",currentPrice:8500,minPrice:6e3,endTime:new Date(Date.now()+1800*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:1800,bidCount:4,highestBidder:"長宗我部元親"},{id:28,name:"硯",description:"端渓の硯",currentPrice:42e3,minPrice:32e3,endTime:new Date(Date.now()+1500*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:1500,bidCount:11,highestBidder:"伊達政宗"},{id:29,name:"筆",description:"鼈甲の筆",currentPrice:28e3,minPrice:2e4,endTime:new Date(Date.now()+1200*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1582735689369-4fe89db7114c?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:1200,bidCount:8,highestBidder:"真田幸村"},{id:30,name:"墨",description:"古墨",currentPrice:15e3,minPrice:1e4,endTime:new Date(Date.now()+900*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:900,bidCount:5,highestBidder:"石田三成"},{id:31,name:"和紙",description:"越前和紙",currentPrice:8e3,minPrice:5e3,endTime:new Date(Date.now()+600*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:600,bidCount:3,highestBidder:"大谷吉継"},{id:32,name:"扇子",description:"金箔の扇子",currentPrice:22e3,minPrice:15e3,endTime:new Date(Date.now()+480*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:480,bidCount:7,highestBidder:"小早川秀秋"},{id:33,name:"提灯",description:"ガラス製の提灯",currentPrice:18e3,minPrice:12e3,endTime:new Date(Date.now()+360*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:360,bidCount:4,highestBidder:"福島正則"},{id:34,name:"風鈴",description:"江戸風鈴",currentPrice:12e3,minPrice:8e3,endTime:new Date(Date.now()+240*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:240,bidCount:6,highestBidder:"加藤清正"},{id:35,name:"置物",description:"陶器の置物",currentPrice:25e3,minPrice:18e3,endTime:new Date(Date.now()+120*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1582735689369-4fe89db7114c?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:120,bidCount:9,highestBidder:"黒田長政"},{id:36,name:"花瓶",description:"九谷焼の花瓶",currentPrice:35e3,minPrice:25e3,endTime:new Date(Date.now()+3480*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:3480,bidCount:8,highestBidder:"細川忠興"},{id:37,name:"皿",description:"有田焼の皿",currentPrice:15e3,minPrice:1e4,endTime:new Date(Date.now()+3360*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:3360,bidCount:5,highestBidder:"池田輝政"},{id:38,name:"碗",description:"美濃焼の碗",currentPrice:12e3,minPrice:8e3,endTime:new Date(Date.now()+3240*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:3240,bidCount:4,highestBidder:"浅野幸長"},{id:39,name:"箸",description:"漆塗りの箸",currentPrice:8e3,minPrice:5e3,endTime:new Date(Date.now()+3120*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:3120,bidCount:3,highestBidder:"蜂須賀家政"},{id:40,name:"箸置き",description:"銀製の箸置き",currentPrice:18e3,minPrice:12e3,endTime:new Date(Date.now()+3e3*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:3e3,bidCount:7,highestBidder:"山内一豊"},{id:41,name:"湯呑み",description:"楽焼の湯呑み",currentPrice:1e4,minPrice:7e3,endTime:new Date(Date.now()+2880*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1582735689369-4fe89db7114c?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2880,bidCount:5,highestBidder:"藤堂高虎"},{id:42,name:"急須",description:"急須",currentPrice:22e3,minPrice:15e3,endTime:new Date(Date.now()+2760*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2760,bidCount:8,highestBidder:"井伊直政"},{id:43,name:"茶托",description:"茶托",currentPrice:15e3,minPrice:1e4,endTime:new Date(Date.now()+2640*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2640,bidCount:6,highestBidder:"本多忠勝"},{id:44,name:"茶筒",description:"茶筒",currentPrice:18e3,minPrice:12e3,endTime:new Date(Date.now()+2520*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2520,bidCount:7,highestBidder:"榊原康政"},{id:45,name:"茶筅",description:"茶筅",currentPrice:12e3,minPrice:8e3,endTime:new Date(Date.now()+2400*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2400,bidCount:4,highestBidder:"酒井忠次"},{id:46,name:"茶杓",description:"茶杓",currentPrice:8e3,minPrice:5e3,endTime:new Date(Date.now()+2280*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2280,bidCount:3,highestBidder:"鳥居元忠"},{id:47,name:"茶巾",description:"茶巾",currentPrice:5e3,minPrice:3e3,endTime:new Date(Date.now()+2160*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1582735689369-4fe89db7114c?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2160,bidCount:2,highestBidder:"大久保忠世"},{id:48,name:"茶釜",description:"茶釜",currentPrice:45e3,minPrice:3e4,endTime:new Date(Date.now()+2040*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:2040,bidCount:12,highestBidder:"服部正成"},{id:49,name:"茶炉",description:"茶炉",currentPrice:28e3,minPrice:2e4,endTime:new Date(Date.now()+1920*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:1920,bidCount:8,highestBidder:"柳生宗矩"},{id:50,name:"茶室",description:"茶室",currentPrice:15e4,minPrice:1e5,endTime:new Date(Date.now()+1800*1e3).toISOString(),imageUrl:"https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=400&h=300&fit=crop&crop=center",status:"ACTIVE",timeRemaining:1800,bidCount:25,highestBidder:"千宗室"}];class ue{static async getActiveAuctions(){try{const o=await fetch(`${ee}/products`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch{return console.log("バックエンドに接続できません。ダミーデータを表示します。"),de}}static async getProduct(o){try{const r=await fetch(`${ee}/products/${o}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}catch{console.log("バックエンドに接続できません。ダミーデータを表示します。");const l=de.find(m=>m.id===o);if(l)return l;throw new Error("商品が見つかりません")}}static async placeBid(o){try{const r=await fetch(`${ee}/bid`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!r.ok){const l=await r.json().catch(()=>({}));throw new Error(l.message||`HTTP error! status: ${r.status}`)}return await r.json()}catch{return console.log("バックエンドに接続できません。ダミーの入札処理を実行します。"),{id:Date.now(),productId:o.productId,bidderName:o.bidderName,amount:o.amount,bidTime:new Date().toISOString()}}}}class Ne{constructor(){F(this,"stompClient",null);F(this,"isConnected",!1);F(this,"subscriptions",new Map)}async connect(){return new Promise(async(o,r)=>{try{const l=(await me(async()=>{const{default:c}=await import("./C8h1mmMK.js").then(d=>d.e);return{default:c}},[],import.meta.url)).default,{Stomp:m}=await me(async()=>{const{Stomp:c}=await import("./Tfpyt7Ij.js").then(d=>d.w);return{Stomp:c}},[],import.meta.url),v=new l("http://localhost:8080/ws");this.stompClient=m.over(v),this.stompClient.connect({},()=>{this.isConnected=!0,console.log("WebSocket connected"),o()},c=>{console.error("WebSocket connection failed:",c),r(c)})}catch(l){console.error("Failed to load WebSocket libraries:",l),r(l)}})}disconnect(){this.stompClient&&(this.stompClient.disconnect(),this.isConnected=!1,this.subscriptions.clear(),console.log("WebSocket disconnected"))}subscribeToProduct(o,r){if(!this.isConnected){console.error("WebSocket not connected");return}const l=`/topic/product/${o}`,m=this.stompClient.subscribe(l,v=>{try{const c=JSON.parse(v.body);r(c)}catch(c){console.error("Failed to parse product message:",c)}});this.subscriptions.set(l,m)}subscribeToAuctions(o){if(!this.isConnected){console.error("WebSocket not connected");return}const r="/topic/auctions",l=this.stompClient.subscribe(r,m=>{try{const v=JSON.parse(m.body);o(v)}catch(v){console.error("Failed to parse auctions message:",v)}});this.subscriptions.set(r,l)}unsubscribe(o){const r=this.subscriptions.get(o);r&&(r.unsubscribe(),this.subscriptions.delete(o))}getConnectionStatus(){return this.isConnected}}const xe=window.setInterval,Le={class:"container"},We={key:0,class:"error-message"},Fe={key:1,class:"success-message"},je={key:2,class:"loading"},Je={key:3,class:"dropdown-section"},Ke={class:"time-settings"},Ge={class:"product-info"},He={class:"product-name-small"},Ye={class:"current-time"},ze={class:"time-inputs"},Qe=["onUpdate:modelValue","onChange"],Xe={class:"preset-times"},Ze={class:"preset-buttons"},qe={key:6,class:"auction-grid"},et={class:"product-image-container"},tt=["src","alt","data-product-id","onError"],it={class:"product-name"},nt={class:"product-description"},ot={key:0,class:"time-management"},st=["onClick","disabled"],at=["onClick","disabled"],rt={class:"bid-info"},ct={key:1,class:"bid-form"},lt=["onUpdate:modelValue","min","onKeyup"],mt=["onClick","disabled"],dt={key:2,class:"bid-form"},ut=["onUpdate:modelValue","onKeyup"],ht={key:7,class:"pagination"},gt=["disabled"],pt={class:"page-numbers"},ft=["onClick"],wt=["disabled"],B=16,Ct=Ve({__name:"index",setup(b){const o=u([]),r=u(!0),l=u(""),m=u(""),v=u(!1),c=u({}),d=u({}),C=u(null),O=u(!1),te=u(Date.now()),I=u(null),M=u(new Set),j=u(new Set),J=u(new Set),ie=u(new Set),k=u(!1),N=u(!1),_=u({}),D=u(1),x=new Ne,U={AUCTION_START_TIME:"auction_start_time",PRODUCTS_DATA:"auction_products_data"},L=Q(()=>Math.ceil(o.value.length/B)),he=Q(()=>{const i=(D.value-1)*B,t=i+B,e=o.value.slice(i,t);return e.forEach(n=>{c.value[n.id]||(c.value[n.id]=n.currentPrice+1e3),d.value[n.id]||(d.value[n.id]="")}),e}),ge=Q(()=>{const i=L.value,t=D.value,e=[];if(i<=7)for(let n=1;n<=i;n++)e.push(n);else if(t<=4){for(let n=1;n<=5;n++)e.push(n);e.push(-1),e.push(i)}else if(t>=i-3){e.push(1),e.push(-1);for(let n=i-4;n<=i;n++)e.push(n)}else{e.push(1),e.push(-1);for(let n=t-1;n<=t+1;n++)e.push(n);e.push(-1),e.push(i)}return e}),K=i=>{if(i>=1&&i<=L.value){D.value=i;const t=(i-1)*B,e=t+B;o.value.slice(t,e).forEach(a=>{c.value[a.id]||(c.value[a.id]=a.currentPrice+1e3),d.value[a.id]||(d.value[a.id]="")}),window.scrollTo({top:0,behavior:"smooth"})}},E=["https://images.unsplash.com/photo-1524592094714-0f0654e20314?w=400&h=300&fit=crop&crop=center","https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center","https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=300&fit=crop&crop=center","https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=400&h=300&fit=crop&crop=center","https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop&crop=center","https://images.unsplash.com/photo-1582735689369-4fe89db7114c?w=400&h=300&fit=crop&crop=center","https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=300&fit=crop&crop=center","https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center","https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop&crop=center"],pe=i=>{const t=o.value.find(a=>a.id===i);if(!t)return console.log(`商品が見つかりません: ID ${i}`),E[0];if(ie.value.has(i)){const a=E[i%E.length];return console.log(`代替画像を使用: 商品ID ${i}, URL: ${a}`),a}const e=t.imageUrl;if(e&&e.trim()!=="")return console.log(`商品画像を使用: 商品ID ${i}, URL: ${e}`),e;const n=E[i%E.length];return console.log(`代替画像を使用（imageUrlなし）: 商品ID ${i}, URL: ${n}`),n},fe=i=>{console.log(`画像読み込みエラー: 商品ID ${i}`),ie.value.add(i);const t=document.querySelector(`[data-product-id="${i}"]`);if(t){const e=E[i%E.length];t.src=e}},we=()=>{try{const i=localStorage.getItem(U.AUCTION_START_TIME);i&&(I.value=parseInt(i),console.log("📅 保存されたオークション開始時間を復元しました"));const t=localStorage.getItem(U.PRODUCTS_DATA);if(t){const e=JSON.parse(t);o.value=e,console.log("💾 保存された商品データを復元しました"),o.value.forEach(n=>{c.value[n.id]=n.currentPrice+1e3,d.value[n.id]=""})}}catch(i){console.error("ローカルストレージからの読み込みに失敗:",i)}},y=()=>{try{I.value&&localStorage.setItem(U.AUCTION_START_TIME,I.value.toString()),localStorage.setItem(U.PRODUCTS_DATA,JSON.stringify(o.value))}catch(i){console.error("ローカルストレージへの保存に失敗:",i)}},ne=async()=>{try{r.value=!0;const i=await ue.getActiveAuctions();I.value||(I.value=Date.now(),console.log("🎉 新しいオークションを開始しました！"));const t=i.map((e,n)=>{const a=new Date;let h;switch(n%4){case 0:h=45;break;case 1:h=30;break;case 2:h=20;break;case 3:h=15;break;default:h=25;break}const f=Math.max(5,h-Math.floor(n/4)*2),P=new Date(a.getTime()+f*60*1e3);return{...e,endTime:P.toISOString()}});o.value=t,i.forEach(e=>{c.value[e.id]=e.currentPrice+1e3,d.value[e.id]="";const n=new Date(e.endTime),a=new Date,h=Math.floor((n.getTime()-a.getTime())/1e3);console.log(`📦 商品: ${e.name}, 終了時間: ${n.toLocaleString()}, 残り時間: ${A(h)}`)}),i.length>0&&(O.value=!0,console.log("🎯 商品データ取得完了、オークション開始フラグを設定")),y(),i.length>0&&!C.value&&(console.log("⏱️ fetchProducts後にカウントダウンを開始します"),V()),i.forEach((e,n)=>{const a=new Date(e.endTime),h=new Date,f=Math.floor((a.getTime()-h.getTime())/1e3);console.log(`📦 商品${n+1}: ${e.name}, 終了時間: ${a.toLocaleString()}, 残り時間: ${A(f)}`)})}catch(i){l.value="商品の取得に失敗しました",console.error("Failed to fetch products:",i)}finally{r.value=!1}},ve=i=>M.value.has(i)?"入札中...":"入札",Te=i=>{j.value.add(i),setTimeout(()=>{j.value.delete(i)},600)},G=async i=>{Te(i),setTimeout(()=>{Se(i)},100)},Se=async i=>{const t=c.value[i],e=d.value[i];if(!t||!e){l.value="入札金額と入札者名を入力してください";return}try{M.value.add(i),v.value=!0,l.value="";const n={productId:i,bidderName:e,amount:t};try{await ue.placeBid(n),m.value="入札が完了しました！"}catch{console.log("⚠️ バックエンドが利用できないため、フロントエンド側で処理を実行します"),m.value="入札が完了しました！（フロントエンド処理）"}const a=o.value.find(h=>h.id===i);if(a&&a.status==="ACTIVE"){const h=a.currentPrice,f=new Date(a.endTime),P=new Date,H=Math.floor((f.getTime()-P.getTime())/1e3);if(console.log(`🔍 延長処理開始: 商品ID ${i}, 現在の終了時間: ${f.toLocaleString()}, 残り時間: ${H}秒`),H<3600){const Y=new Date(f.getTime()+1e4);a.endTime=Y.toISOString(),console.log(`⏰ 入札によりオークション時間を延長: 商品ID ${i}, 新しい終了時間: ${Y.toLocaleString()}`);const z=new Date(P.getTime()+36e5);Y.getTime()>z.getTime()&&(a.endTime=z.toISOString(),console.log(`⚠️ 60分制限により終了時間を調整: 商品ID ${i}, 最終終了時間: ${z.toLocaleString()}`))}else console.log(`❌ 延長条件を満たさない: 商品ID ${i}, 残り時間: ${H}秒 (60分以上)`);a.currentPrice=t,a.highestBidder=e,a.bidCount++,h!==a.currentPrice&&(J.value.add(i),setTimeout(()=>{J.value.delete(i)},1500))}c.value[i]=t+1e3,setTimeout(()=>{m.value=""},3e3)}catch(n){l.value=n.message||"入札に失敗しました"}finally{M.value.delete(i),v.value=!1}},S=i=>{const t=new Date(i.endTime).getTime(),e=te.value;return Math.max(0,Math.floor((t-e)/1e3))},A=i=>{if(i<=0)return"00:00:00";const t=Math.floor(i/3600),e=Math.floor(i%3600/60),n=i%60;return`${t.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`},be=i=>i.toLocaleString(),Ce=()=>{te.value=Date.now();let i=!1;o.value.forEach(t=>{if(t.status==="ACTIVE"){const e=S(t);e<=0?(t.status="ENDED",console.log(`⏰ オークション終了: ${t.name} (残り時間: ${A(e)})`)):(i=!0,e<=60&&console.log(`⚠️ 残り時間が少ない商品: ${t.name} (残り時間: ${A(e)})`))}}),!i&&O.value&&console.log("🏁 すべてのオークションが終了しました"),y()},V=()=>{C.value&&(clearInterval(C.value),console.log("🔄 既存のカウントダウンタイマーをクリアしました")),console.log("⏱️ リアルタイムカウントダウンを開始します"),C.value=xe(Ce,500),console.log("✅ カウントダウンタイマーが設定されました")},oe=()=>{C.value&&(clearInterval(C.value),C.value=null,console.log("⏹️ カウントダウンタイマーを停止しました"))},se=(i,t)=>{const e=o.value.find(f=>f.id===i);if(!e||e.status!=="ACTIVE")return;const n=new Date(e.endTime),a=new Date;if(Math.floor((n.getTime()-a.getTime())/1e3)<3600){const f=new Date(n.getTime()+t*1e3);e.endTime=f.toISOString(),console.log(`⏰ 個別時間延長: 商品ID ${i}, ${t}秒延長, 新しい終了時間: ${f.toLocaleString()}`);const P=new Date(a.getTime()+36e5);f.getTime()>P.getTime()&&(e.endTime=P.toISOString(),console.log(`⚠️ 60分制限により終了時間を調整: 商品ID ${i}, 最終終了時間: ${P.toLocaleString()}`)),y(),m.value=`商品「${e.name}」の時間を${t}秒延長しました！`,setTimeout(()=>{m.value=""},3e3)}else l.value="60分以上の残り時間がある商品は延長できません",setTimeout(()=>{l.value=""},3e3)},De=()=>{o.value.forEach(i=>{const t=S(i),e=Math.floor(t/3600),n=Math.floor(t%3600/60),a=t%60;_.value[i.id]={timeRange:"",hours:e,minutes:n,seconds:a}}),N.value=!0},ae=()=>{N.value=!1},Pe=()=>{k.value=!k.value},W=()=>{k.value=!1},Ie=i=>{const t=_.value[i];if(!t||!t.timeRange)return;const e=parseInt(t.timeRange),n=Math.floor(e/60),a=e%60;t.hours=n,t.minutes=a,t.seconds=0,console.log(`⏰ 時間範囲更新: 商品ID ${i}, ${e}分 (${n}時間${a}分)`)},R=i=>{o.value.forEach(t=>{if(t.status==="ACTIVE"){const e=Math.floor(i/60),n=i%60;_.value[t.id]={timeRange:i.toString(),hours:e,minutes:n,seconds:0}}}),m.value=`全商品の時間を${i}分に設定しました！`,setTimeout(()=>{m.value=""},2e3)},Ee=()=>{const i=new Date;o.value.forEach(t=>{const e=_.value[t.id];if(e&&t.status==="ACTIVE"){const n=e.hours*3600+e.minutes*60+e.seconds;if(n>0){const a=new Date(i.getTime()+n*1e3);t.endTime=a.toISOString(),console.log(`⏰ カスタム時間設定: 商品ID ${t.id}, 新しい終了時間: ${a.toLocaleString()}`)}}}),y(),N.value=!1,m.value="個別時間設定を適用しました！",setTimeout(()=>{m.value=""},3e3)},Ae=()=>{I.value=Date.now();const i=new Date;o.value.forEach((t,e)=>{t.status="ACTIVE";const n=new Date(i.getTime()+(60-e*5)*60*1e3);t.endTime=n.toISOString(),console.log(`🔄 商品: ${t.name}, 新しい終了時間: ${n.toLocaleString()}`)}),o.value.forEach(t=>{c.value[t.id]=t.currentPrice+1e3,d.value[t.id]=""}),y(),V(),console.log("🔄 オークション残り時間を初期値にリセットしました"),m.value="オークション残り時間をリセットしました！",setTimeout(()=>{m.value=""},3e3)},$e=async()=>{localStorage.removeItem(U.AUCTION_START_TIME),localStorage.removeItem(U.PRODUCTS_DATA),I.value=null,O.value=!1,o.value=[],c.value={},d.value={},oe(),console.log("🔄 完全リセットを実行しました"),m.value="完全リセットを実行しました！新しいオークションを開始します。";try{await ne(),o.value.length>0&&(console.log("⏱️ 完全リセット後にカウントダウンを開始します"),V())}catch(i){console.error("完全リセット後の商品データ取得に失敗:",i),l.value="商品データの再取得に失敗しました"}setTimeout(()=>{m.value=""},3e3)};Re(o,i=>{i.length>0&&(i.forEach(t=>{c.value[t.id]||(c.value[t.id]=t.currentPrice+1e3),d.value[t.id]||(d.value[t.id]="")}),O.value?C.value||(console.log("🔄 カウントダウンが停止しているため再開始します"),V()):(O.value=!0,console.log("🎉 オークションが開始されました！"),V()))},{deep:!0});const Oe=async()=>{try{await x.connect(),x.subscribeToAuctions(i=>{o.value=i,i.forEach(t=>{c.value[t.id]||(c.value[t.id]=t.currentPrice+1e3),d.value[t.id]||(d.value[t.id]="")})}),o.value.forEach(i=>{x.subscribeToProduct(i.id,t=>{const e=o.value.findIndex(n=>n.id===i.id);if(e!==-1){const n=o.value[e].endTime;if(o.value[e]=t,n!==t.endTime){const a=new Date(t.endTime),h=new Date,f=Math.floor((a.getTime()-h.getTime())/1e3);console.log(`🔄 WebSocket更新: 商品ID ${i.id}, 新しい終了時間: ${a.toLocaleString()}, 残り時間: ${A(f)}`)}c.value[i.id]=t.currentPrice+1e3}})})}catch(i){console.error("WebSocket setup failed:",i)}};return ke(async()=>{we(),o.value.length===0?await ne():(O.value=!0,r.value=!1),await Oe(),o.value.length>0&&V()}),ye(()=>{x.disconnect(),oe()}),(i,t)=>(p(),g("div",Le,[l.value?(p(),g("div",We,w(l.value),1)):T("",!0),m.value?(p(),g("div",Fe,w(m.value),1)):T("",!0),r.value?(p(),g("div",je,t[13]||(t[13]=[s("div",{class:"spinner"},null,-1)]))):T("",!0),!r.value&&o.value.length>0?(p(),g("div",Je,[s("div",{class:$(["dropdown",{open:k.value}])},[s("button",{onClick:Pe,class:"dropdown-toggle"}," ▼ オークション時間設定 "),s("div",{class:"dropdown-menu",onClick:t[3]||(t[3]=re(()=>{},["stop"]))},[s("div",{onClick:t[0]||(t[0]=()=>{Ae(),W()}),class:"dropdown-item"}," 🔄 オークション時間リセット "),s("div",{onClick:t[1]||(t[1]=()=>{De(),W()}),class:"dropdown-item"}," ⏰ 個別時間設定 "),s("div",{onClick:t[2]||(t[2]=()=>{$e(),W()}),class:"dropdown-item danger"}," 🗑️ 完全リセット ")])],2)])):T("",!0),k.value?(p(),g("div",{key:4,class:"dropdown-overlay",onClick:W})):T("",!0),N.value?(p(),g("div",{key:5,class:"modal-overlay",onClick:ae},[s("div",{class:"modal-content",onClick:t[10]||(t[10]=re(()=>{},["stop"]))},[t[16]||(t[16]=s("h3",null,"商品ごとのオークション時間設定",-1)),s("div",Ke,[(p(!0),g(X,null,Z(o.value,e=>(p(),g("div",{key:e.id,class:"time-setting-item"},[s("div",Ge,[s("span",He,w(e.name),1),s("span",Ye,"現在: "+w(A(S(e))),1)]),s("div",ze,[q(s("select",{"onUpdate:modelValue":n=>_.value[e.id].timeRange=n,class:"time-range-select",onChange:n=>Ie(e.id)},t[14]||(t[14]=[Me('<option value="">時間を選択</option><option value="5">5分</option><option value="10">10分</option><option value="15">15分</option><option value="20">20分</option><option value="30">30分</option><option value="45">45分</option><option value="60">1時間</option><option value="90">1.5時間</option><option value="120">2時間</option><option value="180">3時間</option><option value="240">4時間</option><option value="300">5時間</option><option value="360">6時間</option><option value="480">8時間</option><option value="600">10時間</option><option value="720">12時間</option><option value="1440">24時間</option>',18)]),40,Qe),[[Be,_.value[e.id].timeRange]])])]))),128))]),s("div",Xe,[t[15]||(t[15]=s("h4",null,"プリセット時間",-1)),s("div",Ze,[s("button",{onClick:t[4]||(t[4]=e=>R(15)),class:"preset-button"},"15分"),s("button",{onClick:t[5]||(t[5]=e=>R(30)),class:"preset-button"},"30分"),s("button",{onClick:t[6]||(t[6]=e=>R(45)),class:"preset-button"},"45分"),s("button",{onClick:t[7]||(t[7]=e=>R(60)),class:"preset-button"},"1時間"),s("button",{onClick:t[8]||(t[8]=e=>R(90)),class:"preset-button"},"1.5時間"),s("button",{onClick:t[9]||(t[9]=e=>R(120)),class:"preset-button"},"2時間")])]),s("div",{class:"modal-actions"},[s("button",{onClick:Ee,class:"apply-button"},"適用"),s("button",{onClick:ae,class:"cancel-button"},"キャンセル")])])])):T("",!0),r.value?T("",!0):(p(),g("div",qe,[(p(!0),g(X,null,Z(he.value,e=>(p(),g("div",{key:e.id,class:$(["product-card",{ended:e.status==="ENDED"}])},[s("div",et,[s("img",{src:pe(e.id),alt:e.name,"data-product-id":e.id,class:"product-image",onError:n=>fe(e.id)},null,40,tt)]),s("div",{class:$(["status-badge",e.status==="ACTIVE"?"status-active":"status-ended"])},w(e.status==="ACTIVE"?"進行中":"終了"),3),s("h3",it,w(e.name),1),s("p",nt,w(e.description),1),s("div",{class:$(["product-price",{"price-flash":J.value.has(e.id)}])}," ¥"+w(be(e.currentPrice)),3),s("div",{class:$(["countdown",{urgent:S(e)<=300}])},w(A(S(e))),3),e.status==="ACTIVE"?(p(),g("div",ot,[s("button",{onClick:n=>se(e.id,300),class:"extend-button small",disabled:S(e)>=3600}," +5分 ",8,st),s("button",{onClick:n=>se(e.id,600),class:"extend-button small",disabled:S(e)>=3600}," +10分 ",8,at)])):T("",!0),s("div",rt,[s("span",null,"入札数: "+w(e.bidCount),1),s("span",null,"最高入札者: "+w(e.highestBidder),1)]),e.status==="ACTIVE"&&S(e)>0?(p(),g("div",ct,[q(s("input",{"onUpdate:modelValue":n=>c.value[e.id]=n,type:"number",min:e.currentPrice+1,step:1,placeholder:"入札金額",class:"bid-input",onKeyup:le(n=>G(e.id),["enter"])},null,40,lt),[[ce,c.value[e.id]]]),s("button",{onClick:n=>G(e.id),disabled:!c.value[e.id]||v.value,class:$(["bid-button",{bidding:M.value.has(e.id),flash:j.value.has(e.id)}])},w(ve(e.id)),11,mt)])):T("",!0),e.status==="ACTIVE"&&S(e)>0?(p(),g("div",dt,[q(s("input",{"onUpdate:modelValue":n=>d.value[e.id]=n,type:"text",placeholder:"入札者名",class:"bid-input",onKeyup:le(n=>G(e.id),["enter"])},null,40,ut),[[ce,d.value[e.id]]])])):T("",!0)],2))),128))])),!r.value&&L.value>1?(p(),g("div",ht,[s("button",{onClick:t[11]||(t[11]=e=>K(D.value-1)),disabled:D.value===1,class:"pagination-button"}," 前へ ",8,gt),s("div",pt,[(p(!0),g(X,null,Z(ge.value,e=>(p(),g("button",{key:e,onClick:n=>K(e),class:$([{active:e===D.value},"page-button"])},w(e),11,ft))),128))]),s("button",{onClick:t[12]||(t[12]=e=>K(D.value+1)),disabled:D.value===L.value,class:"pagination-button"}," 次へ ",8,wt)])):T("",!0)]))}});export{Ct as default};
